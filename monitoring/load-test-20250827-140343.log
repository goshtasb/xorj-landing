=== FINAL REPORT: 2025-08-27 14:03:43 ===
--- FINAL CONNECTION STATE ---
 total_connections | active_connections | idle_connections | idle_in_transaction | idle_aborted | longest_running_query_seconds 
-------------------+--------------------+------------------+---------------------+--------------+-------------------------------
                 1 |                  1 |                0 |                   0 |            0 |                      0.000000
(1 row)

 application_name | connections | active | idle 
------------------+-------------+--------+------
(0 rows)

                       query_snippet                       | calls |   total_exec_time   |   mean_exec_time    |    max_exec_time    | rows 
-----------------------------------------------------------+-------+---------------------+---------------------+---------------------+------
 SELECT                                                   +|     1 |            0.551375 |            0.551375 |            0.551375 |    0
     application_name,                                    +|       |                     |                     |                     | 
     count(*) as connections,                             +|       |                     |                     |                     | 
     count(case when state = $1 then $2 en                 |       |                     |                     |                     | 
 SELECT pg_stat_statements_reset()                         |     1 | 0.36320800000000003 | 0.36320800000000003 | 0.36320800000000003 |    1
 SELECT                                                   +|     1 |             0.16425 |             0.16425 |             0.16425 |    1
     count(*) as total_connections,                       +|       |                     |                     |                     | 
     count(case when state = $1 then $2 end) as active_con |       |                     |                     |                     | 
(3 rows)

                       query_snippet                       | calls |   total_exec_time   |   mean_exec_time    |  avg_time_per_call  
-----------------------------------------------------------+-------+---------------------+---------------------+---------------------
 SELECT                                                   +|     1 |            0.551375 |            0.551375 |            0.551375
     application_name,                                    +|       |                     |                     | 
     count(*) as connections,                             +|       |                     |                     | 
     count(case when state = $1 then $2 en                 |       |                     |                     | 
 SELECT                                                   +|     1 |            0.099542 |            0.099542 |            0.099542
     left(query, $1) as query_snippet,                    +|       |                     |                     | 
     calls,                                               +|       |                     |                     | 
     total_exec_time,                                     +|       |                     |                     | 
     mean_exec_time,                                      +|       |                     |                     | 
                                                           |       |                     |                     | 
 SELECT                                                   +|     1 |             0.16425 |             0.16425 |             0.16425
     count(*) as total_connections,                       +|       |                     |                     | 
     count(case when state = $1 then $2 end) as active_con |       |                     |                     | 
 SELECT pg_stat_statements_reset()                         |     1 | 0.36320800000000003 | 0.36320800000000003 | 0.36320800000000003
(4 rows)

 locktype | database |     relation     |      mode       | granted |     usename      |                                            query                                             |          query_start          |   age    
----------+----------+------------------+-----------------+---------+------------------+----------------------------------------------------------------------------------------------+-------------------------------+----------
 relation |    16578 | pg_locks         | AccessShareLock | t       | aflatoongoshtasb | SELECT                                                                                      +| 2025-08-27 14:03:43.803792-07 | 00:00:00
          |          |                  |                 |         |                  |     l.locktype,                                                                             +|                               | 
          |          |                  |                 |         |                  |     l.database,                                                                             +|                               | 
          |          |                  |                 |         |                  |     l.relation::regclass,                                                                   +|                               | 
          |          |                  |                 |         |                  |     l.mode,                                                                                 +|                               | 
          |          |                  |                 |         |                  |     l.granted,                                                                              +|                               | 
          |          |                  |                 |         |                  |     a.usename,                                                                              +|                               | 
          |          |                  |                 |         |                  |     a.query,                                                                                +|                               | 
          |          |                  |                 |         |                  |     a.query_start,                                                                          +|                               | 
          |          |                  |                 |         |                  |     age(now(), a.query_start) AS "age"                                                      +|                               | 
          |          |                  |                 |         |                  | FROM pg_locks l                                                                             +|                               | 
          |          |                  |                 |         |                  | LEFT JOIN pg_stat_activity a ON l.pid = a.pid                                               +|                               | 
          |          |                  |                 |         |                  | WHERE l.database = (SELECT oid FROM pg_database WHERE datname = 'xorj_production_localhost')+|                               | 
          |          |                  |                 |         |                  | ORDER BY a.query_start;                                                                      |                               | 
 relation |    16578 | pg_stat_activity | AccessShareLock | t       | aflatoongoshtasb | SELECT                                                                                      +| 2025-08-27 14:03:43.803792-07 | 00:00:00
          |          |                  |                 |         |                  |     l.locktype,                                                                             +|                               | 
          |          |                  |                 |         |                  |     l.database,                                                                             +|                               | 
          |          |                  |                 |         |                  |     l.relation::regclass,                                                                   +|                               | 
          |          |                  |                 |         |                  |     l.mode,                                                                                 +|                               | 
          |          |                  |                 |         |                  |     l.granted,                                                                              +|                               | 
          |          |                  |                 |         |                  |     a.usename,                                                                              +|                               | 
          |          |                  |                 |         |                  |     a.query,                                                                                +|                               | 
          |          |                  |                 |         |                  |     a.query_start,                                                                          +|                               | 
          |          |                  |                 |         |                  |     age(now(), a.query_start) AS "age"                                                      +|                               | 
          |          |                  |                 |         |                  | FROM pg_locks l                                                                             +|                               | 
          |          |                  |                 |         |                  | LEFT JOIN pg_stat_activity a ON l.pid = a.pid                                               +|                               | 
          |          |                  |                 |         |                  | WHERE l.database = (SELECT oid FROM pg_database WHERE datname = 'xorj_production_localhost')+|                               | 
          |          |                  |                 |         |                  | ORDER BY a.query_start;                                                                      |                               | 
(2 rows)

psql:monitoring/database-monitor.sql:85: ERROR:  column "tablename" does not exist
LINE 3:     tablename,
            ^
psql:monitoring/database-monitor.sql:98: ERROR:  column "tablename" does not exist
LINE 3:     tablename,
            ^
